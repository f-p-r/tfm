<nav class="ds-nav" aria-label="Navegación principal">
  <div class="ds-nav-inner">
    <!-- Brand / Logo -->
    <a routerLink="/" class="ds-nav-brand">Naipeando</a>

    <!-- Enlaces / controles desktop -->
    <div class="ds-nav-links">
      <!-- Selector de juegos (desktop) -->
      <label class="sr-only" for="desktop-games">Seleccionar juego</label>
      <select
        id="desktop-games"
        [value]="gamesStore.selectedGame() ?? ''"
        (change)="onDesktopGameChange($event)"
        class="ds-nav-link"
      >
        <option value="">Todos los juegos</option>
        @for (g of gamesStore.sortedGames(); track g) {
          <option [value]="g">{{ g }}</option>
        }
      </select>

      <!-- Resto de enlaces desktop -->
      <a routerLink="/associations" class="ds-nav-link">Asociaciones</a>
      <a routerLink="/events" class="ds-nav-link">Eventos</a>
      <a routerLink="/news" class="ds-nav-link">Noticias</a>
      @if (canSeeAdmin()) {
        <a routerLink="/admin" class="ds-nav-link">Admin</a>
      }
      <button type="button" class="ds-nav-link" (click)="openHelp()" aria-label="Ayuda">?</button>
    </div>

    <!-- Acciones -->
    <div class="ds-nav-actions">
      <!-- Menú de usuario (desktop) -->
      <app-user-menu variant="desktop"></app-user-menu>

      <!-- Botón hamburguesa (mobile) -->
      <button
        type="button"
        class="ds-nav-toggle"
        aria-label="Menú"
        [attr.aria-expanded]="mobileMenuOpen()"
        (click)="toggleMobileMenu()"
      >
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Panel de menú móvil -->
  @if (mobileMenuOpen()) {
    <div class="ds-nav-mobile">
      <div class="ds-nav-mobile-list">
        <!-- Selector de juegos (mobile) -->
        <div class="border-b border-neutral-medium">
          <label for="mobile-games-select" class="sr-only">Seleccionar juego</label>
          <select
            id="mobile-games-select"
            [value]="gamesStore.selectedGame() ?? ''"
            (change)="selectGameMobile($any($event.target).value === '' || $any($event.target).value === 'Todos los juegos' ? null : $any($event.target).value)"
            class="w-full px-4 md:px-6 py-3 border-0 focus:ring-2 focus:ring-brand-primary text-neutral-dark"
          >
            <option value="" [selected]="!gamesStore.selectedGame()">Todos los juegos</option>
            @for (g of gamesStore.sortedGames(); track g) {
              <option [value]="g" [selected]="gamesStore.selectedGame() === g">{{ g }}</option>
            }
          </select>
        </div>
        <a routerLink="/associations" class="ds-nav-mobile-link" (click)="closeMobileMenu()">Asociaciones</a>
        <a routerLink="/events" class="ds-nav-mobile-link" (click)="closeMobileMenu()">Eventos</a>
        <a routerLink="/news" class="ds-nav-mobile-link" (click)="closeMobileMenu()">Noticias</a>
        @if (canSeeAdmin()) {
          <a routerLink="/admin" class="ds-nav-mobile-link" (click)="closeMobileMenu()">Admin</a>
        }
        <button type="button" class="ds-nav-mobile-link text-left" (click)="openHelp()">?</button>
      </div>
    </div>
  }
</nav>

<app-help-panel [isOpen]="helpOpen()" (close)="closeHelp()" />
